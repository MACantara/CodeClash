{% extends "base.html" %}

{% block title %}{{ challenge.problem_name }} - CodeClash{% endblock %}

{% block content %}
<div class="container mx-auto px-2 sm:px-4 py-6 sm:py-8">
    <div class="max-w-6xl mx-auto">
        <!-- Back Button -->
        <div class="mb-4">
            <a href="/difficulty-selector" class="inline-flex items-center gap-2 text-gray-400 hover:text-white transition">
                <i class="bi bi-arrow-left"></i>
                <span>Back to Difficulty Selector</span>
            </a>
        </div>

        <!-- Challenge Header -->
        <div class="bg-gray-800 rounded-lg p-4 sm:p-6 mb-6 border border-gray-700">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4">
                <div>
                    <div class="flex items-center gap-3 mb-2">
                        <span class="text-sm font-semibold px-3 py-1 rounded-full
                            {% if challenge.difficulty == 'foundational' %}bg-green-600/20 text-green-400 border border-green-600
                            {% elif challenge.difficulty == 'easy' %}bg-blue-600/20 text-blue-400 border border-blue-600
                            {% elif challenge.difficulty == 'average' %}bg-yellow-600/20 text-yellow-400 border border-yellow-600
                            {% elif challenge.difficulty == 'difficult' %}bg-red-600/20 text-red-400 border border-red-600
                            {% endif %}">
                            {{ challenge.difficulty.capitalize() }}
                        </span>
                        <span class="text-sm text-gray-400">#{{ challenge.problem_number }}</span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-white">{{ challenge.problem_name }}</h1>
                </div>
                <div class="flex gap-2">
                    <button onclick="location.href='/random/{{ challenge.difficulty }}'" 
                            class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition flex items-center gap-2">
                        <i class="bi bi-shuffle"></i>
                        <span class="hidden sm:inline">Another {{ challenge.difficulty.capitalize() }}</span>
                        <span class="sm:hidden">Random</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Challenge Content -->
        <div class="max-w-4xl mx-auto">
            <div class="space-y-6">
                <!-- Description -->
                <div class="bg-gray-800 rounded-lg p-4 sm:p-6 border border-gray-700">
                    <h2 class="text-xl font-bold mb-3 flex items-center gap-2">
                        <i class="bi bi-file-text text-blue-500"></i>
                        Description
                    </h2>
                    <p class="text-gray-300 leading-relaxed">{{ challenge.description }}</p>
                </div>

                <!-- Input/Output Specifications -->
                <div class="bg-gray-800 rounded-lg p-4 sm:p-6 border border-gray-700">
                    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="bi bi-arrow-left-right text-green-500"></i>
                        Input/Output
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <h3 class="font-semibold text-green-400 mb-2">Input:</h3>
                            <p class="text-sm text-gray-300">{{ challenge.input_specification }}</p>
                        </div>
                        <div>
                            <h3 class="font-semibold text-blue-400 mb-2">Output:</h3>
                            <p class="text-sm text-gray-300">{{ challenge.output_specification }}</p>
                        </div>
                    </div>
                </div>

                <!-- Examples -->
                <div class="bg-gray-800 rounded-lg p-4 sm:p-6 border border-gray-700">
                    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="bi bi-lightbulb text-yellow-500"></i>
                        Examples
                    </h2>
                    <div class="space-y-4">
                        {% for i in range(challenge.sample_inputs|length) %}
                        <div class="bg-gray-900 rounded p-3 border border-gray-700">
                            <div class="mb-2">
                                <span class="text-xs font-semibold text-gray-400">Input:</span>
                                <code class="block bg-gray-950 p-2 rounded mt-1 text-sm text-green-400">{{ challenge.sample_inputs[i] }}</code>
                            </div>
                            <div class="mb-2">
                                <span class="text-xs font-semibold text-gray-400">Output:</span>
                                <code class="block bg-gray-950 p-2 rounded mt-1 text-sm text-blue-400">{{ challenge.sample_outputs[i] }}</code>
                            </div>
                            {% if challenge.explanations and i < challenge.explanations|length %}
                            <div>
                                <span class="text-xs font-semibold text-gray-400">Explanation:</span>
                                <p class="text-sm text-gray-300 mt-1">{{ challenge.explanations[i] }}</p>
                            </div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Hints (Collapsible) -->
                {% if challenge.hints %}
                <div class="bg-gray-800 rounded-lg p-4 sm:p-6 border border-gray-700">
                    <button onclick="toggleHints()" class="w-full flex items-center justify-between text-xl font-bold mb-2">
                        <span class="flex items-center gap-2">
                            <i class="bi bi-question-circle text-purple-500"></i>
                            Hints
                        </span>
                        <i id="hints-icon" class="bi bi-chevron-down"></i>
                    </button>
                    <div id="hints-content" class="hidden space-y-2 mt-4">
                        {% for hint in challenge.hints %}
                        <div class="bg-gray-900 rounded p-3 text-sm text-gray-300 flex items-start gap-2">
                            <i class="bi bi-lightbulb-fill text-yellow-500 mt-1"></i>
                            <span>{{ hint }}</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Notes -->
                {% if challenge.notes %}
                <div class="bg-gray-800 rounded-lg p-4 sm:p-6 border border-gray-700">
                    <h2 class="text-xl font-bold mb-3 flex items-center gap-2">
                        <i class="bi bi-info-circle text-cyan-500"></i>
                        Notes
                    </h2>
                    <ul class="space-y-2">
                        {% for note in challenge.notes %}
                        <li class="text-sm text-gray-300 flex items-start gap-2">
                            <i class="bi bi-dot text-cyan-500 text-xl"></i>
                            <span>{{ note }}</span>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Toggle hints visibility
function toggleHints() {
    const hintsContent = document.getElementById('hints-content');
    const hintsIcon = document.getElementById('hints-icon');
    
    hintsContent.classList.toggle('hidden');
    hintsIcon.classList.toggle('bi-chevron-down');
    hintsIcon.classList.toggle('bi-chevron-up');
}
</script>
{% endblock %}
